name: Auto Update Status

on:
schedule:
  - cron: '0 21 * * *'  # 每天UTC时间21点（北京时间5点）
  - cron: '0 8 * * *'   # 每天UTC时间8点（北京时间16点）
  workflow_dispatch:    # 可以手动触发

jobs:
  update_status:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v3
        with:
          python-version: '3.8'

      - name: Install requests
        run: pip install requests

      - name: Run status check script
        run: |
          python3 -c "
import requests
from datetime import date

status_url='https://raw.githubusercontent.com/virtually321/autoclock/main/status.txt'

def update_status():
    # 这里可以自己定义获取状态的逻辑
    # 比如：请求API，或者换成你自己的逻辑
    # 暂用固定值示例
    new_status='0'  # 或 '1'
    response=requests.get(status_url)
    # 你可以根据API返回内容写这部分逻辑
    with open('status.txt','w') as f:
        f.write(new_status)

update_status()
"
      - name: Commit updated status.txt
        run: |
          git config --global user.name 'github-actions'
          git config --global user.email 'actions@github.com'
          git add status.txt
          git commit -m "Auto-update status" || echo "No changes"
          git push
